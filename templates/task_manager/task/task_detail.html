{% extends "layouts/base.html" %}
{% load crispy_forms_filters %}
{% block content %}
  <div class="container text-white">
    <h3 class="text-white">
      {{ task.name }}
      <br>
      {% if task.is_completed %}
        <a href="{% url 'task_manager:task_status_update' task.id %}" class="btn btn-sm btn-warning mt-3">Restore</a>
      {% else %}
        <a href="{% url 'task_manager:task_status_update' task.id %}" class="btn btn-sm btn-success mt-3">Complete</a>
      {% endif %}
      <a href="{% url 'task_manager:task_update' task.id %}" class="btn btn-sm btn-info mt-3">Update</a>
      <a href="{% url 'task_manager:task_delete' task.id %}" class="btn btn-sm btn-danger mt-3">Delete</a>
    </h3>
    <hr>
    <p>Description: {{ task.description }}</p>
    <hr>
    <p>Priority: {{ task.priority }}<br> Deadline: {{ task.deadline }}</p>
    <hr>
  </div>
  <div class="container">
    <h2>Chat</h2>
    <form
        action="{% url 'task_manager:message_create' pk_author=user.id pk_task=task.pk %}"
        method="post" class="opacity-7">
      {% csrf_token %}
      <div class="bg-white row w-70">
        {{ message_form|crispy }}
      </div>
      <input type="submit" value="Send" class="btn btn-success btn-lg mt-3">
    </form>


  </div>
  <div>
    {% for mes in messages %}
      {% if mes.author.id == user.id %}
        <div class="col-md-6 offset-md-6">
          <div class="text-white">{{ mes }} <a href="#" class="btn btn-danger btn-sm"> Delete</a></div>
          <hr>
          <br>
        </div>
      {% else %}
        <div class="col-md-6">
          <div class="text-white message sent">{{ mes }} <a href="#" class="btn btn-danger btn-sm">ðŸ—‘</a></div>
          <hr>
          <br>
        </div>
      {% endif %}
    {% endfor %}
  </div>
  {% include "includes/chat.html" %}
{% endblock %}